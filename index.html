<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="description" content="MagicMist">
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    <link rel="apple-touch-icon" href="Mist.png">
    <title>MagicMist</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
            -webkit-user-select: none;
            user-select: none;
        }

        /* 关键：重置html和body的尺寸和定位 */
        html {
            width: 100vw;
            height: 100vh;
            overflow: hidden;
            background: #000000; /* 设置根元素背景为黑色 */
        }

        body {
            width: 100%;
            height: 100%;
            overflow: hidden;
            font-family: "PingFang SC", -apple-system, BlinkMacSystemFont, sans-serif;
            background-color: #000000; /* 改为黑色背景 */
            color: #FFFFFF; /* 文字改为白色 */
            font-weight: 700;
            position: relative;
            touch-action: none;
            /* 确保body不会限制内容区域 */
            margin: 0;
            padding: 0;
        }

        /* 认证界面 - 使用黑色背景 */
        #auth-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #000000; /* 改为黑色背景 */
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            align-items: center;
            padding-top: env(safe-area-inset-top);
            padding-bottom: env(safe-area-inset-bottom);
            z-index: 100;
            overflow: hidden;
            transition: opacity 0.3s ease;
            /* 确保认证界面不会影响主内容区域 */
            box-sizing: border-box;
        }

        .auth-image-container {
            flex: 1;
            display: flex;
            justify-content: center;
            align-items: center;
            width: 100%;
        }

        .auth-image {
            width: 220px;
            height: 220px;
            background: url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjIwIiBoZWlnaHQ9IjIyMCIgdmlld0JveD0iMCAwIDIyMCAyMjAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIyMjAiIGhlaWdodD0iMjIwIiByeD0iMjAiIGZpbGw9IiMxRTFFMUUiLz4KPHBhdGggZD0iTTExMCA2MEMxMzMuMTM3IDYwIDE1MiA3OC44NjM0IDE1MiAxMDJDMTUyIDEyNS4xMzcgMTMzLjEzNyAxNDQgMTEwIDE0NEM4Ni44NjM0IDE0NCA2OCAxMjUuMTM3IDY4IDEwMkM2OCA3OC44NjM0IDg2Ljg2MzQgNjAgMTEwIDYwWiIgZmlsbD0iI0ZGRkZGRiIvPgo8cGF0aCBkPSJNMTEwIDE2MEM4Ni44NjM0IDE2MCA2OCAxMzMuMTM3IDY4IDExMEM2OCAxMDQuNDc3IDY5LjM1MjYgOTkuMjA3MSA3MS43ODI2IDk0LjUzMjFDNzEuODQ3NiA5NC40MTcxIDcxLjkxNzYgOTQuMzA3MSA3Mi4wMDI2IDk0LjIwNzFDODAuNjU3NiA4MC45MDIxIDk0LjQ0MjYgNzIgMTEwIDcyQzEyNS41NTc0IDcyIDEzOS4zNDI0IDgwLjkwMjEgMTQ3Ljk5NzQgOTQuMjA3MUMxNDguMDgyNCA5NC4zMDcxIDE0OC4xNTI0IDk0LjQxNzEgMTQ4LjIxNzQgOTQuNTMyMUMxNTAuNjQ3NCA5OS4yMDcxIDE1MiAxMDQuNDc3IDE1MiAxMTBDMTUyIDEzMy4xMzcgMTMzLjEzNyAxNjAgMTEwIDE2MFoiIGZpbGw9IiNGRkZGRkYiLz4KPC9zdmc+') center/contain no-repeat;
            position: relative;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 4px 12px rgba(255, 255, 255, 0.1); /* 阴影改为浅色 */
            transition: transform 0.3s ease;
        }

        .auth-image:active {
            transform: scale(0.98);
        }

        .auth-button-container {
            width: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .auth-button {
            background: #FFFFFF; /* 按钮背景改为白色 */
            color: #000000; /* 按钮文字改为黑色 */
            border: none;
            border-radius: 30px;
            padding: 16px 40px;
            font-size: 18px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: "PingFang SC", -apple-system, BlinkMacSystemFont, sans-serif;
            position: relative;
            overflow: hidden;
        }

        .auth-button:active {
            transform: scale(0.95);
            opacity: 0.8;
        }

        .auth-button:disabled {
            opacity: 0.7;
            cursor: not-allowed;
        }

        .auth-button-loading .auth-button-text {
            opacity: 0;
        }

        .auth-button-loading::after {
            content: "";
            position: absolute;
            width: 20px;
            height: 20px;
            top: 50%;
            left: 50%;
            margin-left: -10px;
            margin-top: -10px;
            border: 2px solid #000000; /* 加载动画改为黑色 */
            border-radius: 50%;
            border-top-color: transparent;
            animation: spin 1s ease infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .auth-status {
            margin-top: 15px;
            color: rgba(255, 255, 255, 0.7); /* 状态文字改为白色半透明 */
            font-size: 14px;
            min-height: 20px;
            text-align: center;
            font-weight: 700;
            transition: color 0.3s ease;
        }

        /* 主内容区域 - 完全独立的覆盖层 */
        #content-container {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: #000000;
            z-index: 50; /* 确保低于认证界面但高于body */
            opacity: 0;
            transition: opacity 0.3s ease;
            overflow: hidden;
            /* 关键：使用视口单位确保覆盖整个屏幕 */
            margin: 0;
            padding: 0;
            /* 扩展覆盖安全区域 */
            top: calc(-1 * env(safe-area-inset-top, 0px));
            left: calc(-1 * env(safe-area-inset-left, 0px));
            width: calc(100% + env(safe-area-inset-left, 0px) + env(safe-area-inset-right, 0px));
            height: calc(100% + env(safe-area-inset-top, 0px) + env(safe-area-inset-bottom, 0px));
        }

        #content-container.active {
            opacity: 1;
            display: block;
        }

        /* 主内容区域布局 - 增加容器大小 */
        .main-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 90%;
            max-width: 900px; /* 增加最大宽度 */
            min-height: 600px; /* 增加最小高度 */
            text-align: center;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 60px 40px; /* 增加内边距 */
            border-radius: 30px; /* 圆角边框 */
            overflow: hidden; /* 确保伪元素不溢出 */
            background-color: rgba(0, 0, 0, 0.4); /* 添加半透明背景增强可读性 */
        }

        /* 添加模糊圆角背景 - 使用CSS渐变和SVG内联图片 */
        .main-content::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-image: 
                radial-gradient(circle at 30% 30%, rgba(50, 50, 50, 0.8) 0%, rgba(0, 0, 0, 0.9) 70%),
                url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjIwIiBoZWlnaHQ9IjIyMCIgdmlld0JveD0iMCAwIDIyMCAyMjAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIyMjAiIGhlaWdodD0iMjIwIiByeD0iMjAiIGZpbGw9IiMxRTFFMUUiLz4KPHBhdGggZD0iTTExMCA2MEMxMzMuMTM3IDYwIDE1MiA3OC44NjM0IDE1MiAxMDJDMTUyIDEyNS4xMzcgMTMzLjEzNyAxNDQgMTEwIDE0NEM4Ni44NjM0IDE0NCA2OCAxMjUuMTM3IDY4IDEwMkM2OCA3OC44NjM0IDg2Ljg2MzQgNjAgMTEwIDYwWiIgZmlsbD0iI0ZGRkZGRiIvPgo8cGF0aCBkPSJNMTEwIDE2MEM4Ni44NjM0IDE2MCA2OCAxMzMuMTM3IDY4IDExMEM2OCAxMDQuNDc3IDY5LjM1MjYgOTkuMjA3MSA3MS43ODI2IDk0LjUzMjFDNzEuODQ3NiA5NC40MTcxIDcxLjkxNzYgOTQuMzA3MSA3Mi4wMDI2IDk0LjIwNzFDODAuNjU3NiA4MC45MDIxIDk0LjQ0MjYgNzIgMTEwIDcyQzEyNS41NTc0IDcyIDEzOS4zNDI0IDgwLjkwMjEgMTQ3Ljk5NzQgOTQuMjA3MUMxNDguMDgyNCA5NC4zMDcxIDE0OC4xNTI0IDk0LjQxNzEgMTQ4LjIxNzQgOTQuNTMyMUMxNTAuNjQ3NCA5OS4yMDcxIDE1MiAxMDQuNDc3IDE1MiAxMTBDMTUyIDEzMy4xMzcgMTMzLjEzNyAxNjAgMTEwIDE2MFoiIGZpbGw9IiNGRkZGRkYiLz4KPC9zdmc+');
            background-size: cover, 200% 200%;
            background-position: center, 0% 0%;
            background-repeat: no-repeat;
            filter: blur(15px) brightness(0.6); /* 调整模糊效果和亮度 */
            border-radius: 30px; /* 圆角边框 */
            z-index: -1; /* 确保背景在内容后面 */
            animation: backgroundMove 20s infinite linear;
        }

        @keyframes backgroundMove {
            0% { background-position: center, 0% 0%; }
            25% { background-position: center, 100% 0%; }
            50% { background-position: center, 100% 100%; }
            75% { background-position: center, 0% 100%; }
            100% { background-position: center, 0% 0%; }
        }

        /* 主内容图片 - 使用内联SVG确保加载 */
        .content-image {
            width: 280px;
            height: 280px;
            background: url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjgwIiBoZWlnaHQ9IjI4MCIgdmlld0JveD0iMCAwIDI4MCAyODAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIyODAiIGhlaWdodD0iMjgwIiByeD0iMjUiIGZpbGw9IiMxRTFFMUUiLz4KPHBhdGggZD0iTTE0MCA3MEMxNzAuNDYxIDcwIDE5NSA5NC41MzkxIDE5NSAxMjVDMTk1IDE1NS40NjEgMTcwLjQ2MSAxODAgMTQwIDE4MEMxMDkuNTM5IDE4MCA4NSAxNTUuNDYxIDg1IDEyNUM4NSA5NC41MzkxIDEwOS41MzkgNzAgMTQwIDcwWiIgZmlsbD0iI0ZGRkZGRiIvPgo8cGF0aCBkPSJNMTQwIDIwNUMxMDkuNTM5IDIwNSA4NSAxNzAuNDYxIDg1IDE0MEM4NSAxMzMuNjA5IDg2LjcyMTcgMTI3LjQ5MiA4OS44NDg1IDEyMS45MjdDODkuOTQxNSAxMjEuNzkzIDkwLjA0MTUgMTIxLjY2MyA5MC4xNTM1IDEyMS41NDNDMTAyLjY2MzUgMTAzLjE0NyAxMjAuMjM1IDkwIDE0MCA5MEMxNTkuNzY1IDkwIDE3Ny4zMzY1IDEwMy4xNDcgMTg5Ljg0NjUgMTIxLjU0M0MxODkuOTU4NSAxMjEuNjYzIDE5MC4wNTg1IDEyMS43OTMgMTkwLjE1MTUgMTIxLjkyN0MxOTMuMjc4MyAxMjcuNDkyIDE5NSAxMzMuNjA5IDE5NSAxNDBDMTk1IDE3MC40NjEgMTcwLjQ2MSAyMDUgMTQwIDIwNVoiIGZpbGw9IiNGRkZGRkYiLz4KPC9zdmc+') center/contain no-repeat;
            margin-bottom: 40px; /* 增加底部间距 */
            border-radius: 25px;
            box-shadow: 0 8px 25px rgba(255, 255, 255, 0.1); /* 阴影改为浅色 */
            position: relative; /* 确保图片在模糊背景之上 */
            z-index: 1;
        }

        /* 文本轮换区域 - 优化显示效果 */
        .text-rotator {
            width: 100%;
            text-align: center;
            color: #FFFFFF; /* 保持白色 */
            font-size: 52px; /* 调整字体大小 */
            font-weight: 700;
            font-family: "Hiragino Maru Gothic ProN", "Hiragino Kaku Gothic ProN", "Hiragino Sans", "Yu Gothic", "Meiryo", sans-serif;
            height: 90px; /* 增加容器高度 */
            overflow: hidden;
            position: relative;
            /* 添加半透明背景使文本更易读 */
            background-color: rgba(0, 0, 0, 0.6);
            border-radius: 15px;
            padding: 15px 20px;
            z-index: 1; /* 确保文本在模糊背景之上 */
            margin-top: 10px; /* 添加上边距 */
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .rotating-text {
            position: absolute;
            width: 100%;
            opacity: 0;
            transform: translateY(20px); /* 调整动画起始位置 */
            transition: all 0.4s ease;
            font-weight: 700;
            font-family: inherit; /* 确保文本元素也使用相同的字体 */
            color: #FFFFFF; /* 确保文本颜色一致 */
            text-align: center;
            line-height: 1.2; /* 优化行高 */
        }

        .rotating-text.active {
            opacity: 1;
            transform: translateY(0);
        }

        .rotating-text.exiting {
            opacity: 0;
            transform: translateY(-20px); /* 调整动画结束位置 */
        }

        /* 响应式设计 */
        @media (max-width: 768px) {
            .auth-image {
                width: 180px;
                height: 180px;
                border-radius: 16px;
            }
            
            .content-image {
                width: 220px;
                height: 220px;
                margin-bottom: 30px;
            }
            
            .text-rotator {
                font-size: 44px; /* 平板设备上的字体大小 */
                height: 80px;
                padding: 12px 16px;
            }
            
            .main-content {
                padding: 50px 30px;
                border-radius: 25px;
                min-height: 550px;
            }
            
            .main-content::before {
                border-radius: 25px;
            }
        }

        @media (max-width: 480px) {
            .auth-button {
                padding: 14px 32px;
                font-size: 16px;
            }
            
            .auth-image {
                width: 150px;
                height: 150px;
                border-radius: 14px;
            }
            
            .content-image {
                width: 180px;
                height: 180px;
                margin-bottom: 25px;
                border-radius: 20px;
            }
            
            .text-rotator {
                font-size: 36px; /* 手机设备上的字体大小 */
                height: 70px;
                padding: 10px 14px;
            }
            
            .main-content {
                padding: 40px 20px;
                border-radius: 20px;
                min-height: 500px;
            }
            
            .main-content::before {
                border-radius: 20px;
            }
        }
        
        /* 防止滚动 */
        .no-scroll {
            overflow: hidden;
        }

        /* 为不支持env()的浏览器提供回退 */
        @supports not (top: env(safe-area-inset-top)) {
            #content-container {
                top: calc(-1 * constant(safe-area-inset-top, 0px));
                left: calc(-1 * constant(safe-area-inset-left, 0px));
                width: calc(100% + constant(safe-area-inset-left, 0px) + constant(safe-area-inset-right, 0px));
                height: calc(100% + constant(safe-area-inset-top, 0px) + constant(safe-area-inset-bottom, 0px));
            }
        }
    </style>
</head>
<body class="no-scroll">
    <!-- Face ID认证界面 -->
    <div id="auth-container">
        <div class="auth-image-container">
            <div class="auth-image" role="img" aria-label="MagicMist应用图标"></div>
        </div>
        <div class="auth-button-container">
            <button class="auth-button" id="authButton" aria-describedby="authStatus">
                <span class="auth-button-text">Face ID认证</span>
            </button>
            <div class="auth-status" id="authStatus" aria-live="polite"></div>
        </div>
    </div>

    <!-- 主内容区域 -->
    <div id="content-container">
        <div class="main-content">
            <div class="content-image" role="img" aria-label="MagicMist应用图标"></div>
            <div class="text-rotator" id="textRotator">
                <!-- 文本将通过JavaScript动态添加 -->
            </div>
        </div>
    </div>

    <script>
        // 应用配置
        const CONFIG = {
            // WebAuthn配置
            webauthn: {
                rpName: "MagicMist",
                userName: "霧@MagicMist",
                userDisplayName: "霧@MagicMist'",
                timeout: 60000
            },
            
            // 文本轮换配置
            textRotation: {
                texts: [
                    "霧",
                    "雾", 
                    "Mist",
                    "Tipcy"
                ],
                interval: 1200, // 1.2秒轮换一次，加快速度
                transitionDuration: 400 // 过渡动画时长也相应加快
            }
        };
        
        // 应用状态管理
        const AppState = {
            isAuthenticated: false,
            credentialId: null
        };
        
        // DOM元素引用
        const DOM = {
            authContainer: document.getElementById('auth-container'),
            contentContainer: document.getElementById('content-container'),
            authButton: document.getElementById('authButton'),
            authButtonText: document.querySelector('.auth-button-text'),
            authStatus: document.getElementById('authStatus'),
            textRotator: document.getElementById('textRotator')
        };
        
        // 文本轮换管理器
        const TextRotator = {
            currentIndex: 0,
            intervalId: null,
            
            // 初始化文本轮换
            init: function() {
                // 创建文本元素
                this.createTextElements();
                
                // 显示第一个文本
                this.showText(0);
                
                // 开始轮换
                this.startRotation();
            },
            
            // 创建文本元素
            createTextElements: function() {
                DOM.textRotator.innerHTML = '';
                
                CONFIG.textRotation.texts.forEach((text, index) => {
                    const textElement = document.createElement('div');
                    textElement.className = 'rotating-text';
                    textElement.textContent = text;
                    textElement.dataset.index = index;
                    DOM.textRotator.appendChild(textElement);
                });
            },
            
            // 显示指定索引的文本
            showText: function(index) {
                const texts = document.querySelectorAll('.rotating-text');
                
                // 移除所有活动类
                texts.forEach(text => {
                    text.classList.remove('active', 'exiting');
                });
                
                // 设置新文本为活动状态
                if (texts[index]) {
                    texts[index].classList.add('active');
                }
                
                this.currentIndex = index;
            },
            
            // 切换到下一个文本
            nextText: function() {
                const texts = document.querySelectorAll('.rotating-text');
                const currentText = texts[this.currentIndex];
                
                // 添加退出动画类
                if (currentText) {
                    currentText.classList.add('exiting');
                }
                
                // 计算下一个索引
                const nextIndex = (this.currentIndex + 1) % texts.length;
                
                // 延迟显示新文本，确保过渡效果可见
                setTimeout(() => {
                    this.showText(nextIndex);
                }, CONFIG.textRotation.transitionDuration);
            },
            
            // 开始轮换
            startRotation: function() {
                this.intervalId = setInterval(() => {
                    this.nextText();
                }, CONFIG.textRotation.interval);
            },
            
            // 停止轮换
            stopRotation: function() {
                if (this.intervalId) {
                    clearInterval(this.intervalId);
                    this.intervalId = null;
                }
            },
            
            // 重置轮换
            reset: function() {
                this.stopRotation();
                this.currentIndex = 0;
                this.showText(0);
                this.startRotation();
            }
        };
        
        // 认证管理器
        const AuthManager = {
            // 初始化认证
            init: function() {
                // 检查是否支持WebAuthn
                if (!window.PublicKeyCredential) {
                    this.showError("您的设备不支持生物识别功能");
                    DOM.authButton.disabled = true;
                    return;
                }
                
                // 检查是否有已保存的通行密钥
                this.checkExistingCredentials();
                
                // 添加认证按钮事件监听
                DOM.authButton.addEventListener('click', () => this.startAuthentication());
                
                // 防止滚动
                this.preventScroll();
            },
            
            // 防止页面滚动
            preventScroll: function() {
                document.body.addEventListener('touchmove', function(e) {
                    e.preventDefault();
                }, { passive: false });
                
                document.addEventListener('scroll', function(e) {
                    e.preventDefault();
                    window.scrollTo(0, 0);
                });
            },
            
            // 检查已有凭证
            checkExistingCredentials: function() {
                try {
                    const savedCredentialId = localStorage.getItem('webauthn_credential_id');
                    
                    if (savedCredentialId) {
                        AppState.credentialId = Uint8Array.from(savedCredentialId.split(',').map(Number));
                        DOM.authButtonText.textContent = "使用Face ID登录";
                    } else {
                        DOM.authButtonText.textContent = "注册Face ID";
                    }
                } catch (error) {
                    console.error("检查已保存凭证时出错:", error);
                    DOM.authButtonText.textContent = "Face ID认证";
                }
            },
            
            // 开始认证流程
            startAuthentication: async function() {
                try {
                    DOM.authButton.disabled = true;
                    DOM.authButton.classList.add('auth-button-loading');
                    this.updateStatus("准备认证中...");
                    
                    if (AppState.credentialId) {
                        this.updateStatus("请使用Face ID进行认证...");
                        await this.authenticateWithCredential();
                    } else {
                        this.updateStatus("正在注册Face ID...");
                        await this.registerNewCredential();
                    }
                } catch (error) {
                    console.error("认证失败:", error);
                    this.showError("认证失败: " + error.message);
                    DOM.authButton.disabled = false;
                    DOM.authButton.classList.remove('auth-button-loading');
                }
            },
            
            // 注册新凭证
            registerNewCredential: async function() {
                const challenge = new Uint8Array(32);
                crypto.getRandomValues(challenge);
                
                const publicKey = {
                    challenge: challenge,
                    rp: { 
                        id: window.location.hostname, 
                        name: CONFIG.webauthn.rpName
                    },
                    user: {
                        id: new Uint8Array(16),
                        name: CONFIG.webauthn.userName,
                        displayName: CONFIG.webauthn.userDisplayName
                    },
                    pubKeyCredParams: [
                        { type: "public-key", alg: -7 }
                    ],
                    authenticatorSelection: {
                        userVerification: "required",
                        requireResidentKey: false
                    },
                    timeout: CONFIG.webauthn.timeout,
                    attestation: "none"
                };
                
                const credential = await navigator.credentials.create({ publicKey });
                
                if (credential && credential.rawId) {
                    AppState.credentialId = new Uint8Array(credential.rawId);
                    localStorage.setItem('webauthn_credential_id', Array.from(AppState.credentialId).join(','));
                }
                
                this.onAuthenticationSuccess();
            },
            
            // 使用已有凭证认证
            authenticateWithCredential: async function() {
                const challenge = new Uint8Array(32);
                crypto.getRandomValues(challenge);
                
                const publicKey = {
                    challenge: challenge,
                    rpId: window.location.hostname,
                    allowCredentials: [
                        {
                            type: "public-key",
                            id: AppState.credentialId,
                            transports: ["internal"]
                        }
                    ],
                    userVerification: "required",
                    timeout: CONFIG.webauthn.timeout
                };
                
                const assertion = await navigator.credentials.get({ publicKey });
                
                if (assertion) {
                    this.onAuthenticationSuccess();
                } else {
                    throw new Error("认证失败");
                }
            },
            
            // 认证成功处理
            onAuthenticationSuccess: function() {
                AppState.isAuthenticated = true;
                UI.showContent();
            },
            
            // 更新状态信息
            updateStatus: function(message) {
                DOM.authStatus.textContent = message;
            },
            
            // 显示错误信息
            showError: function(message) {
                DOM.authStatus.textContent = message;
                DOM.authStatus.style.color = '#ff6b6b';
            }
        };
        
        // UI管理器
        const UI = {
            // 显示内容区域
            showContent: function() {
                // 先隐藏认证界面
                DOM.authContainer.style.opacity = "0";
                
                setTimeout(() => {
                    // 完全隐藏认证界面
                    DOM.authContainer.style.display = "none";
                    
                    // 显示主内容区域
                    DOM.contentContainer.style.display = "block";
                    
                    // 强制重绘
                    DOM.contentContainer.offsetHeight;
                    
                    // 激活主内容区域
                    setTimeout(() => {
                        DOM.contentContainer.classList.add('active');
                        
                        // 额外确保：设置body背景为黑色
                        document.body.style.backgroundColor = "#000000";
                        document.body.style.background = "#000000";
                        
                        // 设置html背景为黑色
                        document.documentElement.style.backgroundColor = "#000000";
                        document.documentElement.style.background = "#000000";
                        
                        // 启动文本轮换
                        TextRotator.init();
                    }, 50);
                }, 300);
            }
        };
        
        // 初始化应用
        function initApp() {
            // 初始化认证
            AuthManager.init();
        }
        
        // 启动应用
        document.addEventListener('DOMContentLoaded', initApp);
        
        // 防止滚动
        window.addEventListener('scroll', preventScroll, { passive: false });
        window.addEventListener('touchmove', preventScroll, { passive: false });
        
        function preventScroll(e) {
            e.preventDefault();
            window.scrollTo(0, 0);
            return false;
        }
    </script>
</body>
</html>